(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{706:function(s,a,t){"use strict";t.r(a);var e=t(11),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("如果忘记了 root 密码，或者接手了一个不知道密码的 Gitlab，可以通过重置密码进行恢复。")]),s._v(" "),t("p",[s._v("登录到 Gitlab 服务器，执行如下命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("gitlab-rails console production\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果此时有报错：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("Traceback "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("most recent call last"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(": from bin/rails:4:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("'\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(": from bin/rails:4:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("require"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    6: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/commands.rb:18:in `<top (required)>'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command.rb:46:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke'\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command/base.rb:69:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("perform"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    3: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke_command'\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("run"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n/opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/commands/console/console_command.rb:95:in `perform'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" wrong number of arguments "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("given "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", expected "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ArgumentError"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(": from bin/rails:4:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("'\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(": from bin/rails:4:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("require"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    7: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/commands.rb:18:in `<top (required)>'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command.rb:46:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke'\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command/base.rb:69:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("perform"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    4: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke_command'\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:20:in "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("run"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    1: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:34:in `rescue in run'")]),s._v("\n/opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:506:in `handle_argument_error': ERROR: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rails console"')]),s._v(" was called with arguments "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"production"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Thor::InvocationError"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nUsage: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rails console [options]"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/2afb7898edfbc2d9.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("则可能是 Gitlab 版本不一样，然后参数方式不一样，需要用如下方式：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("gitlab-rails console -e production\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("接着查询一下用户：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User.where"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".first\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<User id:1 @root>")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后修改密码：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user.password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11111111"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后保存：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user.save"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nEnqueued ActionMailer::DeliveryJob "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Job ID: 1f015e02-34bc-4b26-8e37-3101937b7ce1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to Sidekiq"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mailers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" with arguments: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DeviseMailer"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password_change"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deliver_now"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<GlobalID:0x00007fa6b83b1378 @uri=#<URI::GID gid://gitlab/User/1>>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("保存之后，可以使用如上密码 test 进行登陆，登陆之后，记得更改密码！")])])}),[],!1,null,null,null);a.default=r.exports}}]);
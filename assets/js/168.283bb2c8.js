(window.webpackJsonp=window.webpackJsonp||[]).push([[168],{731:function(s,a,e){"use strict";e.r(a);var t=e(11),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"_1-快速部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-快速部署"}},[s._v("#")]),s._v(" 1，快速部署")]),s._v(" "),e("p",[s._v("使用如下命令快速创建 VPN 服务 server 端：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker run --name ipsec-vpn-server --env-file /data/jump/vpn/.env --restart"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(":500/udp -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4500")]),s._v(":4500/udp -v /lib/modules:/lib/modules:ro -d --privileged registry.cn-hangzhou.aliyuncs.com/eryajf/ipsec-vpn-server\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("其中用户名密码配置文件内容为：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /data/jump/vpn/.env\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Define your own values for these variables")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - DO NOT put \"\" or '' around values, or add space around =")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - DO NOT use these special characters within values: \\ \" '")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_IPSEC_PSK")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("6JhixxWU0u9REqATiFrEAG0\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置用于登陆VPN的账号和密码")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_USER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("9s0RrJX4qEoQG7L32s9I\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如下应该填写本机的外网IP")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_PUBLIC_IP")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".0.2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (Optional) Define additional VPN users")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - Uncomment and replace with your own values")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - Usernames and passwords must be separated by spaces")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置额外的用户名和密码")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_ADDL_USERS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("user1 user2\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_ADDL_PASSWORDS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pass1 pass2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (Optional) Use alternative DNS servers")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - By default, clients are set to use Google Public DNS")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - Example below shows using Cloudflare's DNS service")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_DNS_SRV1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("223.5")]),s._v(".5.5\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VPN_DNS_SRV2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("223.6")]),s._v(".6.6\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("p",[s._v("一个用户名对应一个密码，如果需要新增， 更改配置文件，重启服务即可。注意服务器需要有外网 IP，以及放开对应端口。")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("查看 IPsec VPN 服务器状态")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it ipsec-vpn-server ipsec status\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("查看当前已建立的 VPN 连接")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it ipsec-vpn-server ipsec whack --trafficstatus\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h2",{attrs:{id:"_2-客户端连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-客户端连接"}},[s._v("#")]),s._v(" 2，客户端连接")]),s._v(" "),e("p",[s._v("目前手上只有 Mac 电脑，所以着重介绍下 Mac 的连接方式。")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("打开网络偏好设置详情")]),s._v(" "),e("p",[e("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/fb0849c2f8e7c454.jpg",alt:"img"}})])]),s._v(" "),e("li",[e("p",[s._v("然后点击左侧加号新建连接")]),s._v(" "),e("p",[e("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/588f39f5c9c82ca2.jpg",alt:""}})]),s._v(" "),e("p",[s._v("注意服务器地址应该填写服务端的外网 IP，账户名称则是上边对应的账号。")]),s._v(" "),e("p",[s._v("点击认证设置，需要填写密码与共享秘钥，秘钥是上边配置文件中的 "),e("code",[s._v("VPN_IPSEC_PSK")]),s._v("。")]),s._v(" "),e("p",[e("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/650bf2d17bd00ab3.jpg",alt:"img"}})])])]),s._v(" "),e("p",[s._v("还要注意一个配置项，点击下边的高级，记得勾选通过 VPN 发送所有流量：")]),s._v(" "),e("p",[e("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/edac09160041938d.jpg",alt:"img"}})]),s._v(" "),e("p",[s._v("配置完毕之后，点击应用，然后点击连接，如无问题，则配置完毕。")]),s._v(" "),e("h2",{attrs:{id:"_3-参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-参考"}},[s._v("#")]),s._v(" 3，参考")]),s._v(" "),e("ul",[e("li",[s._v("https://github.com/hwdsl2/docker-ipsec-vpn-server/blob/master/README-zh.md")]),s._v(" "),e("li",[e("strong",[e("a",{attrs:{href:"https://github.com/hwdsl2/setup-ipsec-vpn/blob/master/docs/clients-zh.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置 IPsec/L2TP VPN 客户端"),e("OutboundLink")],1)])])])])}),[],!1,null,null,null);a.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{658:function(s,e,t){"use strict";t.r(e);var a=t(11),r=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("针对实战使用进行讲解分析，不简简单单罗列命令参数了事。")]),s._v(" "),t("h2",{attrs:{id:"_1-构建使用。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-构建使用。"}},[s._v("#")]),s._v(" 1，构建使用。")]),s._v(" "),t("p",[s._v("静态文件部署，一般会用到此命令，完整命令如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avz --progress -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ssh -p 34222'")]),s._v(" --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Jenkinsfile'")]),s._v(" --delete "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v("/  root@192.168.0.1:/data/test/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-a")]),s._v("：--archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD")]),s._v(" "),t("li",[t("code",[s._v("-v")]),s._v("：输出详细过程")]),s._v(" "),t("li",[t("code",[s._v("-z")]),s._v("：对正在备份的文件进行压缩处理")]),s._v(" "),t("li",[t("code",[s._v("-r")]),s._v("：对子目录以递归模式处理")]),s._v(" "),t("li",[t("code",[s._v("-l")]),s._v("：保留软连接")]),s._v(" "),t("li",[t("code",[s._v("-p")]),s._v("：保持文件权限")]),s._v(" "),t("li",[t("code",[s._v("-t")]),s._v("：保持文件时间信息")]),s._v(" "),t("li",[t("code",[s._v("-g")]),s._v("：保持文件属组信息")]),s._v(" "),t("li",[t("code",[s._v("-o")]),s._v("：保持文件属主信息")]),s._v(" "),t("li",[t("code",[s._v("-D")]),s._v("：保持设备文件信息")]),s._v(" "),t("li",[t("code",[s._v("-e")]),s._v("： –rsh=command 指定使用rsh、ssh方式进行数据同步，一般使用ssh")]),s._v(" "),t("li",[t("code",[s._v("exclude")]),s._v(": 排除某文件的同步，可以多个。")]),s._v(" "),t("li",[t("code",[s._v("--delete")]),s._v("：删除那些DST中SRC没有的文件。")]),s._v(" "),t("li",[t("code",[s._v("--progress")]),s._v("：显示每个文件传输的进度。知道是否有大型文件正在备份可能是有用的。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/e086da4217285fcf.jpg",alt:"5b5d835c55ef6201fc92907e92e2b610"}})]),s._v(" "),t("h2",{attrs:{id:"_2-其他注意。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-其他注意。"}},[s._v("#")]),s._v(" 2，其他注意。")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("将dirA的所有文件同步到dirB内，并删除dirB内多余的文件")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avz --delete dirA/ dirB/ \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("源目录和目标目录结构一定要一致！！不能是dirA/* dirB/ 或者dirA/ dirB/* 或者 dirA/* dirB/*，如果不遵守，那么就不会删除。")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("将dirA的所有文件同步到dirB，但是在dirB内除了fileB3.txt这个文件不删之外，其他的都删除")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avz --delete --exclude "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileB3.txt"')]),s._v(" dirA/ dirB/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("将dirA目录内的fileA1.txt和fileA2.txt不同步到dirB目录内")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avz --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileA1.txt"')]),s._v(" --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileA2.txt"')]),s._v(" dirA/ dirB/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("将dirA目录内的fileA1.txt和fileA2.txt不同步到dirB目录内，并且在dirB目录内删除多余的文件")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avz --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileA1.txt"')]),s._v(" --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileA2.txt"')]),s._v(" --delete dirA/ dirB/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("将dirA目录内的fileA1.txt和fileA2.txt不同步到dirB目录内，并且在dirB目录内删除多余的文件，同时，如果dirB内有fileA2.txt和fileA1.txt这两个被排除同步的文件，仍然将其删除")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avz --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileA1.txt"')]),s._v(" --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileA2.txt"')]),s._v(" --delete-excluded dirA/ dirB/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])])])}),[],!1,null,null,null);e.default=r.exports}}]);